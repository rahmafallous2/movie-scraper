name: Movie Data Scraper (TESTING - Every Minute)

on:
  schedule:
    - cron: '*/1 * * * *'
  workflow_dispatch:

jobs:
  scrape:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout repository
        uses: actions/checkout@v4

      - name: Set up Python
        uses: actions/setup-python@v4
        with:
          python-version: '3.11'

      - name: Install Python dependencies (if present)
        run: |
          python -m pip install --upgrade pip
          if [ -f "./requirements.txt" ]; then
            echo "Found requirements.txt — installing dependencies"
            python -m pip install -r "./requirements.txt"
          else
            echo "::warning::No requirements.txt found at repo root; skipping dependency install"
          fi

      - name: Run scraper (only if an entrypoint exists)
        run: |
          # Try common entrypoints; if none exist, print a message and succeed
          if [ -f "./main.py" ]; then
            python main.py
          elif [ -f "./scraper.py" ]; then
            python scraper.py
          else
            echo "No main.py or scraper.py found — nothing to run in this job"
          fi